#!/usr/bin/env bash

close() {
    workspace=$(wmctrl -d | grep -e '[0-9]\+ \+\*' | cut -d' ' -f1)
    windowIds=$(wmctrl -l | grep -e '^0x[0-9a-f]\+ \+'$workspace | cut -d' ' -f1)

    for win in $windowIds; do
        wmctrl -ic $win
    done
}

ws=$1
cd

i3-msg "append_layout .config/i3/$ws.json"

if [ $ws = bci ]; then
    signal-desktop &
    cd connecthomer
fi

if [ $ws = uni ]; then
    cd Documents/TUB
fi

case $ws in
    uni) ;&
    bkits) ;&
    netsec) ;&
    bci) ;&
    cd) ;&
    statistik)
        [ "$PWD" != "$HOME" ] && cd ~/tubCloud/s21/$ws ;&
    dotfiles)
        gnome-terminal -- tmux new-session -As $ws & ;&
    main)
        firefox -P $ws
        ;;
    -c)
        close
        ;;
    *)
        exit 1
        ;;
esac
